<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 04 - Lead exposure and personality</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-chevron-circle-right')) {
    f.classList.add('fa-chevron-circle-down')
    f.classList.remove('fa-chevron-circle-right')
} else {
    f.classList.add('fa-chevron-circle-right')
    f.classList.remove('fa-chevron-circle-down')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Lab 04 - Lead exposure and personality</h1>

</div>


<p>More and more, epidemiologists are uncovering the alarmingly detrimental effects of environmental pollution for human health and well-being. As has long been known, childhood lead exposure has particularly damaging and lifelong consequences, with even low levels stunting intellectual development. The ancient Romans famously lined their aqueducts with lead, which some have speculated may have hastened the empire’s downfall by contaminating their drinking water (<a href="https://dl.tufts.edu/concern/pdfs/6395wk23b">Nriagu,1983</a>).</p>
<p>More recently, atmospheric lead exposure from leaded gasoline was substantial across the developed world. Fortunately, in the U.S. the Clean Air Act of 1970 began transitioning away from the use of leaded gasoline, though it wasn’t outright banned in the U.S. until 1996. Some epidemiologists and economists believe that reduced lead exposure (especially during childhood) is at least partly responsible for reductions in crime since the 80s and 90s (<a href="https://www-sciencedirect-com.ezproxy1.lib.asu.edu/science/article/pii/S0166046222000667">Higney et al., 2022</a>).</p>
<p>However, the benefits of environmental reforms are often not felt evenly. Leaded gasoline was used in the developing world long after it was banned in most Western nations—the last stockpiles were only finally used up by Algeria in July of 2021 (<a href="https://www.npr.org/2021/08/30/1031429212/the-world-has-finally-stopped-using-leaded-gasoline-algeria-used-the-last-stockp">NPR</a>)! And even in the U.S., many communities are still exposed to too much lead and other environmental pollutants, especially communities of color like Flint, MI.</p>
<p>The idea that an environmental pollutant could harm health is worrying. The idea that it could stunt one’s intellect, or even impair one’s decision-making is perhaps unsettling on another level. But could lead exposure do something even deeper than all that—could it change your personality?</p>
<p>In this lab we’ll explore data from a recent <a href="https://psyarxiv.com/nxdca/">paper</a> by Schwaba and colleagues (2022) published in the <em>Proceedings of the National Academy of Sciences</em> that explores this question.</p>
<div class="lo">
<p><strong>LEARNING OBJECTIVES</strong></p>
<ul>
<li>Visualizing correlations</li>
<li>Visualizing spatial data</li>
<li>Joining data frames</li>
</ul>
</div>
<div class="red">
<p><strong>RECOMMENDED READING</strong></p>
<p><a href="https://www.motherjones.com/environment/2016/02/lead-exposure-gasoline-crime-increase-children-health/">“Lead: America’s Real Criminal Element” (<em>Mother Jones</em>)</a> by Kevin Drum, a leading proponent of the “lead-crime hypothesis” (also recommended, its <a href="https://en.wikipedia.org/wiki/Lead%E2%80%93crime_hypothesis">wikipedia entry</a>).</p>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>Go to the course RStudio Cloud Workspace and locate the folder for the lab assignment, which should be named <code>Assignments: Module 4</code>.</p>
<p>First, open the R Markdown document <code>mod-04-lab.Rmd</code> and Knit it.</p>
<p>Make sure it compiles without errors and you can preview the output within the Viewer Pane.</p>
<p>The output should also be automatically saved as an <code>.html</code> file with the same name.</p>
<div id="warm-up" class="section level2">
<h2>Warm up</h2>
<p>Before we introduce the data, let’s warm up with a simple exercise.</p>
<ul>
<li>Update the YAML, changing the author name to your name, and <strong>knit</strong> the document.</li>
</ul>
</div>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>We’ll use the <strong>tidyverse</strong> package for much of the data wrangling.</p>
<p>This package is already installed for you.</p>
<p>You can load it by running the following in your Console:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(maps)</span></code></pre></div>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>We’re going to work with two datasets in this lab, both of which can be found as CSV (comma-separated values) files in the <code>data</code> folder of your repository.</p>
<p>You can read the first of these in using the following, we’ll call it <code>survey</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/eu-pers-survey.csv&quot;</span>)</span></code></pre></div>
<p>The variable descriptions are as follows:</p>
<table>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Country</code></td>
<td>Name of country</td>
</tr>
<tr class="even">
<td><code>mean_e</code></td>
<td>Avg. Extraversion score</td>
</tr>
<tr class="odd">
<td><code>sd_e</code></td>
<td>Std. Dev. of Extraversion</td>
</tr>
<tr class="even">
<td><code>mean_a</code></td>
<td>Avg. Agreeableness score</td>
</tr>
<tr class="odd">
<td><code>sd_a</code></td>
<td>Std. Dev. of Extraversion</td>
</tr>
<tr class="even">
<td><code>mean_c</code></td>
<td>Avg. Conscientiousness score</td>
</tr>
<tr class="odd">
<td><code>sd_c</code></td>
<td>Std. Dev. of Conscientiousness</td>
</tr>
<tr class="even">
<td><code>mean_n</code></td>
<td>Avg. Neuroticism score</td>
</tr>
<tr class="odd">
<td><code>sd_n</code></td>
<td>Std. Dev. of Neuroticism</td>
</tr>
<tr class="even">
<td><code>mean_o</code></td>
<td>Avg. Openness score</td>
</tr>
<tr class="odd">
<td><code>sd_o</code></td>
<td>Std. Dev. of Openness</td>
</tr>
<tr class="even">
<td><code>mean_age</code></td>
<td>Avg. age of respondents</td>
</tr>
<tr class="odd">
<td><code>n</code></td>
<td>Number of respondents</td>
</tr>
</tbody>
</table>
<p>The second dataset we will use is some country-level statistics for all European Union countries. You can read in the second dataset with the following, calling it <code>eudata</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>eudata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/eu-country-data.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="exercises" class="section level1">
<h1>Exercises</h1>
<div id="get-to-know-your-data" class="section level2">
<h2>Get to know your data</h2>
<hr />
<ol style="list-style-type: decimal">
<li>I didn’t give you an explanation of the <code>eudata</code> variables. Look at the names of the variables in the <code>eudata</code> data. What do you think the data in each of these variables represents?</li>
</ol>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>Let’s inspect our <code>survey</code> data to see if it contains responses from all EU countries. Write the code to see which countries are missing in the <code>survey</code> dataset as compared to the <code>eudata</code> dataset?</li>
</ol>
<p>To help with this exercise, you could print out the country variable in each by indexing the data frames with the <code>$</code> operator. Then, squint at these two lists and see if you can find any differences.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>survey<span class="sc">$</span>Country</span></code></pre></div>
<pre><code>##  [1] &quot;Albania&quot;              &quot;Armenia&quot;              &quot;Austria&quot;             
##  [4] &quot;Bosnia &amp; Herzegovina&quot; &quot;Belgium&quot;              &quot;Bulgaria&quot;            
##  [7] &quot;Switzerland&quot;          &quot;Cyprus&quot;               &quot;Czechia&quot;             
## [10] &quot;Germany&quot;              &quot;Denmark&quot;              &quot;Estonia&quot;             
## [13] &quot;Spain&quot;                &quot;Finland&quot;              &quot;France&quot;              
## [16] &quot;United Kingdom&quot;       &quot;Greece&quot;               &quot;Croatia&quot;             
## [19] &quot;Hungary&quot;              &quot;Iceland&quot;              &quot;Italy&quot;               
## [22] &quot;Liechtenstein&quot;        &quot;Lithuania&quot;            &quot;Luxembourg&quot;          
## [25] &quot;Latvia&quot;               &quot;Malta&quot;                &quot;Netherlands&quot;         
## [28] &quot;Norway&quot;               &quot;Poland&quot;               &quot;Portugal&quot;            
## [31] &quot;Romania&quot;              &quot;Serbia&quot;               &quot;Sweden&quot;              
## [34] &quot;Slovenia&quot;             &quot;Slovakia&quot;             &quot;Turkey&quot;              
## [37] &quot;Ukraine&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>eudata<span class="sc">$</span>Country</span></code></pre></div>
<pre><code>##  [1] &quot;Albania&quot;                &quot;Armenia&quot;                &quot;Austria&quot;               
##  [4] &quot;Bosnia and Herzegovina&quot; &quot;Belgium&quot;                &quot;Bulgaria&quot;              
##  [7] &quot;Switzerland&quot;            &quot;Cyprus&quot;                 &quot;Czech Republic&quot;        
## [10] &quot;Germany&quot;                &quot;Denmark&quot;                &quot;Estonia&quot;               
## [13] &quot;Spain&quot;                  &quot;Finland&quot;                &quot;France&quot;                
## [16] &quot;United Kingdom&quot;         &quot;Greece&quot;                 &quot;Croatia&quot;               
## [19] &quot;Hungary&quot;                &quot;Iceland&quot;                &quot;Italy&quot;                 
## [22] &quot;Liechtenstein&quot;          &quot;Lithuania&quot;              &quot;Luxembourg&quot;            
## [25] &quot;Latvia&quot;                 &quot;Malta&quot;                  &quot;Netherlands&quot;           
## [28] &quot;Norway&quot;                 &quot;Poland&quot;                 &quot;Portugal&quot;              
## [31] &quot;Romania&quot;                &quot;Serbia&quot;                 &quot;Sweden&quot;                
## [34] &quot;Slovenia&quot;               &quot;Slovakia&quot;               &quot;Turkey&quot;                
## [37] &quot;Ukraine&quot;</code></pre>
<p>If you’re going cross-eyed, there is a better way. In fact, it’s the way I want you to use.
Write one or two lines of code using the <code>%in%</code> operator to see which of the countries from one dataset are NOT in the list of countries from the other dataset.</p>
<div class="green">
<p><strong>HINT:</strong> You should get back two countries. You will also see that it’s not so much these two countries are missing from each data set, but they are spelled differently across the two datasets.</p>
</div>
<hr />
</div>
<div id="joining-data-frames" class="section level2">
<h2>Joining data frames</h2>
<p>To investigate whether lead exposure is related to personality, we need to join the two data frames into one.</p>
<p>But, we’re going to have problems with the <code>Country</code> variable in each dataset because of those two countries that are misspelled.</p>
<p>This is how our problematic countries are spelled in the <code>eudata</code> dataset:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>eudata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(Country, <span class="st">&quot;(Czech|Bosnia)&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Country)</span></code></pre></div>
<pre><code>## [1] &quot;Bosnia and Herzegovina&quot; &quot;Czech Republic&quot;</code></pre>
<p>And this is how they are spelled in the <code>survey</code> dataset:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>survey <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(Country, <span class="st">&quot;(Czech|Bosnia)&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Country)</span></code></pre></div>
<pre><code>## [1] &quot;Bosnia &amp; Herzegovina&quot; &quot;Czechia&quot;</code></pre>
<div class="frame">
<p><strong>NOTE:</strong> The code above uses something called a <a href="https://en.wikipedia.org/wiki/Regular_expression">“regular expression”</a> in the <code>str_detect</code> function to check where the values of <code>Country</code> match either “Czech” or “Bosnia”. Regular expressions are powerful tools for working with text, though we will keep things simple in this course.</p>
</div>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>Now that we know what the problem is, use the <code>case_when</code> function to recode the <code>Country</code> variable in the <code>eudata</code> data frame to match how they are written in the <code>survey</code> data.</li>
</ol>
<hr />
<ol start="4" style="list-style-type: decimal">
<li>Now we are ready to join the data frames. Join them on the <code>Country</code> variable. Will it make a difference which kind of join you perform?</li>
</ol>
<hr />
</div>
<div id="claim-lead-exposure-affects-agreeableness" class="section level2">
<h2>Claim: Lead exposure affects “agreeableness”</h2>
<p>In this paper it is argued that lead exposure is associated with lower agreeableness, so that people exposed to more lead are less agreeable.</p>
<ol start="5" style="list-style-type: decimal">
<li>Make a plot to examine whether there is any association between the average agreeableness score in each country and the average lead exposure. What do you conclude?</li>
</ol>
<p>This is what your code should produce:</p>
<p><img src="mod-04-lead-personality_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="exploring-further-geography" class="section level2">
<h2>Exploring further: Geography</h2>
<p>You have surely heard that “correlation is not causation” — so we can’t say whether there is any causal relationship between agreeableness and lead exposure. One reason is that an association between two variables could be <em>confounded</em>—e.g. there might be some other third variable that affects them both and that produces the association. We’ll talk about this more later in the course, but for now let’s briefly explore some possibilities by looking at another kind of visualization: a map.</p>
<p>One thing we might think could influence personality is geography. Without playing too much into broad stereotypes, there are many historical and cultural differences between people in Eastern Europe versus Western Europe. Maybe people in the East or West are more or less agreeable? Maybe they also happen to have more or less lead exposure?</p>
<p>The <code>ggplot2</code> package includes a function called <code>map_data()</code> that loads data for plotting maps of different parts of the world. The code below loads data with latitude (lat) and longitude (long) points marking the boundaries of all the different nations of the world and then turns that <code>data.frame</code> object into a <code>tibble</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">map_data</span>(<span class="st">&quot;world&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>## # A tibble: 99,338 × 6
##     long   lat group order region subregion
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1 -69.9  12.5     1     1 Aruba  &lt;NA&gt;     
##  2 -69.9  12.4     1     2 Aruba  &lt;NA&gt;     
##  3 -69.9  12.4     1     3 Aruba  &lt;NA&gt;     
##  4 -70.0  12.5     1     4 Aruba  &lt;NA&gt;     
##  5 -70.1  12.5     1     5 Aruba  &lt;NA&gt;     
##  6 -70.1  12.6     1     6 Aruba  &lt;NA&gt;     
##  7 -70.0  12.6     1     7 Aruba  &lt;NA&gt;     
##  8 -70.0  12.6     1     8 Aruba  &lt;NA&gt;     
##  9 -69.9  12.5     1     9 Aruba  &lt;NA&gt;     
## 10 -69.9  12.5     1    10 Aruba  &lt;NA&gt;     
## # ℹ 99,328 more rows</code></pre>
<p>If we join this with our <code>combined</code> data, we will be ready to plot a map of the variable we’re interested in.</p>
<ol start="6" style="list-style-type: decimal">
<li>Join the <code>map_data("world")</code> with the <code>combined</code> data to create a new dataset. Make sure to do so in a way that only keeps the countries we have data for in the <code>combined</code> dataset. You can assign this new dataset to a variable just called <code>d</code>.</li>
</ol>
<div class="green">
<p><strong>Hint:</strong> Pay attention to the fact I wrote you want to prioritize the countries in the <code>combined</code> dataset. The <code>map_data("world")</code> dataset has way more countries than we need. So which join function do you want to use? Next, you need to specify in the join function which variable in each dataset has the countries we want to join on (using the <code>by = c(VAR1=VAR2)</code> argument).</p>
</div>
<div class="frame">
<p>Short variable names like <code>d</code> can be useful for “temporary” data that won’t be used for more than one thing. We’re only going to be using <code>d</code> to make our map plots, but we wouldn’t use it for any other kinds of analysis, so the short and generically non-descript name can be OK here.</p>
</div>
<hr />
<div id="map-it" class="section level3">
<h3>Map it!</h3>
<p>Now we’re ready to make our map to explore the possibility of geographic differences. The code below creates the basic map.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group=</span>group)) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() </span></code></pre></div>
<p><img src="mod-04-lead-personality_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Modify the code above to plot agreeableness by country. What you produce should look like so:</li>
</ol>
<p><img src="mod-04-lead-personality_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="green">
<p><strong>Hint:</strong> To generate this, use the <code>fill</code> option in the <code>aes()</code>, making <code>fill</code> equal to the agreeableness variable. And then, somewhere in your code, you will use the viridis color scheme to make it look nicer with <code>scale_fill_viridis_c()</code></p>
</div>
<ol start="8" style="list-style-type: decimal">
<li><p>Now do what you just did, but now plot lead exposure by country instead of agreeableness.</p></li>
<li><p>Write-up: Compare the plots. Do you notice any patterns? Does the geographic explanation of the association between agreeableness and lead exposure seem plausible?</p></li>
</ol>
<hr />
<p>Now go back through your write up to make sure you’ve answered all questions and all of your R chunks are properly labelled.</p>
<div class="red">
<p><strong>SUBMITTING YOUR WORK</strong></p>
<p>Once you decide that you’re done with this lab, change the YAML <code>output</code> from <code>html_output</code> to <code>pdf_output.</code> Now knit the document to produce a final PDF file. Upload the PDF as a Canvas assignment.</p>
</div>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
