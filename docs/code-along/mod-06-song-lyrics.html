<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mod-06-song-lyrics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="mod-06-song-lyrics_files/libs/clipboard/clipboard.min.js"></script>
<script src="mod-06-song-lyrics_files/libs/quarto-html/quarto.js"></script>
<script src="mod-06-song-lyrics_files/libs/quarto-html/popper.min.js"></script>
<script src="mod-06-song-lyrics_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mod-06-song-lyrics_files/libs/quarto-html/anchor.min.js"></script>
<link href="mod-06-song-lyrics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mod-06-song-lyrics_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mod-06-song-lyrics_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mod-06-song-lyrics_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mod-06-song-lyrics_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">mod-06-song-lyrics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="tuning-in-to-psychological-change-linguistic-markers-of-psychological-traits-and-emotions-over-time-in-popular-u.s.-song-lyrics-link" class="level1">
<h1><strong>Tuning in to psychological change: Linguistic markers of psychological traits and emotions over time in popular U.S. song lyrics [<a href="https://psycnet.apa.org/record/2011-05681-001">LINK</a>]</strong></h1>
<p>American culture is filled with cultural products. Yet few studies have investigated how changes in cultural products correspond to changes in psychological traits and emotions. The current research fills this gap by testing the hypothesis that one cultural product—word use in popular song lyrics—changes over time in harmony with cultural changes in individualistic traits. Linguistic analyses of the most popular songs from 1980–2007 demonstrated changes in word use that mirror psychological change. Over time, use of words related to self-focus and antisocial behavior increased, whereas words related to other-focus, social interactions, and positive emotion decreased. These findings offer novel evidence regarding the need to investigate how changes in the tangible artifacts of the sociocultural environment can provide a window into understanding cultural changes in psychological processes.</p>
</section>
<section id="part-1-extracting-the-top-10-artists-of-all-time" class="level1">
<h1>Part 1: Extracting the Top 10 Artists of all Time</h1>
<section id="source-www.billboard.com" class="level3">
<h3 class="anchored" data-anchor-id="source-www.billboard.com"><em>Source: www.billboard.com</em></h3>
<ul>
<li><p>Determine the URL you’d like to pull information from. Utilize the read_html() function to transform the URL into an HTML document.</p></li>
<li><p>Pinpoint the CSS selector that targets the specific data you wish to obtain. A basic understanding of HTML and CSS can be beneficial. If not, you can leverage the Chrome extension, <a href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb">SelectorGadget</a>, to assist in identifying the CSS selector. A quick tip: simply right-click on a page element in Chrome and choose “<strong>Inspect</strong>”.</p></li>
<li><p>Employ the html_nodes() function combined with the identified CSS selector to retrieve your desired data.</p></li>
<li><p>Finally, store your extracted information in a data frame. I’ve opted for tibbles in this case (they’re somewhat more user-friendly compared to traditional data frames).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the url from where you want to extract data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://www.billboard.com/charts/greatest-of-all-time-pop-songs-artists"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(base_url)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the artist name</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage, <span class="st">"h3"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the CSS selector "h3" is the hard part. It exists, it's just being patient in finding it</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the tibble</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>top_artists <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">artist =</span> artists) <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_artists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  artist           
  &lt;chr&gt;            
1 Rihanna          
2 P!nk             
3 Maroon 5         
4 Katy Perry       
5 Justin Timberlake
6 Britney Spears   </code></pre>
</div>
</div>
</section>
<section id="part-2-extracting-popular-songs-and-lyrics-of-the-top-10-artists" class="level2">
<h2 class="anchored" data-anchor-id="part-2-extracting-popular-songs-and-lyrics-of-the-top-10-artists"><strong>PART 2 : Extracting Popular Songs and Lyrics of the Top 10 Artists</strong></h2>
<section id="source-httpsgenius.com" class="level3">
<h3 class="anchored" data-anchor-id="source-httpsgenius.com"><em>Source: https://genius.com</em></h3>
<p>Having secured the list of the Top 10 Pop Artists, navigate to genius.com to pinpoint their trending songs and obtain the corresponding lyrics.</p>
<ul>
<li>Begin by determining the artist’s specific webpage URL. Through some exploration on the site, it’s apparent that artist pages consistently adhere to this format:</li>
</ul>
<p><code>https://genius.com/artists/&lt;artistname&gt;</code></p>
<ul>
<li><p>And we know the “top_artists” tibble has what we need for “&lt;artistname&gt;”. To get things in the right format, we need to combine the URL base “https://genius.com/artists/” with each entry in “top_artists”. Here is an easy way of doing it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>url_base <span class="ot">&lt;-</span> <span class="st">"https://genius.com/artists/"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">'{url_base}'</span>, <span class="st">'{top_artists$artist}'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(urls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://genius.com/artists/Rihanna
https://genius.com/artists/P!nk
https://genius.com/artists/Maroon 5
https://genius.com/artists/Katy Perry
https://genius.com/artists/Justin Timberlake
https://genius.com/artists/Britney Spears</code></pre>
</div>
</div></li>
<li><p>Let’s start simple and begin with a single artist and identify the URLs associated with their top songs. The hardest part is finding the CSS selectors where the URLs are located!</p></li>
<li><p>To zero in on the precise CSS selector, the SelectorGadget might be helpful.</p></li>
</ul>
</section>
<section id="build-a-list-of-all-the-urls-for-all-song-lyrics-of-a-single-artist" class="level3">
<h3 class="anchored" data-anchor-id="build-a-list-of-all-the-urls-for-all-song-lyrics-of-a-single-artist">Build a list of all the URLs for all song lyrics of a single artist</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read page for a single artist</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(urls[<span class="dv">1</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get list of song links a single artist</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>urls_of_songs_one_artist <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">".mini_card_grid-song"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Finding the CSS selector ".mini_card_grid" is the hard part. It exists, it's just being patient in finding it</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We're trying to find a URL link. Almost nearly all the time, once you find the CSS selector where the links are stored, you can use `html_element("a")` and `html_attr("href")` </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(urls_of_songs_one_artist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://genius.com/Rihanna-work-lyrics"               
[2] "https://genius.com/Eminem-the-monster-lyrics"         
[3] "https://genius.com/Dj-khaled-wild-thoughts-lyrics"    
[4] "https://genius.com/Kendrick-lamar-loyalty-lyrics"     
[5] "https://genius.com/Drake-too-good-lyrics"             
[6] "https://genius.com/Eminem-love-the-way-you-lie-lyrics"</code></pre>
</div>
</div>
</section>
<section id="from-the-list-select-the-first-url-and-lets-scrape-lyrics" class="level3">
<h3 class="anchored" data-anchor-id="from-the-list-select-the-first-url-and-lets-scrape-lyrics">From the list, select the first URL and lets scrape lyrics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get first song link, scrape lyrics</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## read page</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>lyrics <span class="ot">&lt;-</span> <span class="fu">read_html</span>(urls_of_songs_one_artist[<span class="dv">1</span>])</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## get the lyrics</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>song_lyrics <span class="ot">&lt;-</span> lyrics <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">".kUgSbL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Finding the CSS selector ".kUgSbL" is the hard part. It exists, it's just being patient in finding it. </span><span class="al">NOTE</span><span class="co">: It looks like this CSS selector dynamically changes on a routine basis. </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(., <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get song name</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>song_name <span class="ot">&lt;-</span> lyrics <span class="sc">%&gt;%</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">".iMpFIj"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># create tibble</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>artist_lyrics <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">song_title =</span> song_name,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">lyric =</span> song_lyrics</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>artist_lyrics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  song_title lyric                                                              
  &lt;chr&gt;      &lt;chr&gt;                                                              
1 Work       "[Chorus: Rihanna]\nWork, work, work, work, work, workHe said me h…</code></pre>
</div>
</div>
</section>
<section id="lets-turn-what-we-did-into-functions" class="level3">
<h3 class="anchored" data-anchor-id="lets-turn-what-we-did-into-functions">Let’s turn what we did into functions</h3>
<ul>
<li><p>The first function will be to grab all song lyrics from a single artist. It’s a matter of creating a function <code>get_lyrics &lt;- function(url_song){ ... }</code> and copy/pasting within <code>{ ... }</code> the code we wrote above in the section “From the list, select the first URL and lets scrape lyrics.”</p></li>
<li><p>But remember this is a function so the big change is that the function takes an argument (named whatever, here it is called <code>url_song)</code> that is just a placeholder. When we actually apply the function, we will swap out <code>url_song</code> with the variable we want to analyze.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>get_lyrics <span class="ot">&lt;-</span> <span class="cf">function</span>(url_song){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## read page</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  lyrics_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_song)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the lyrics</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  song_lyrics <span class="ot">&lt;-</span> lyrics_page <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".kUgSbL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(., <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get song name</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  song_name <span class="ot">&lt;-</span> lyrics_page <span class="sc">%&gt;%</span> </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".iMpFIj"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text2</span>()</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create tibble</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  artist_lyrics <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">song_title =</span> song_name,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">lyric =</span> song_lyrics</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Now apply the function we just wrote to each of the ten URLs stored in the `urls_of_songs_one_artist` tibble. You can do this with the “map_dfr” function! It’s as easy as the following:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lyrics_all_songs_for_one_artist <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(urls_of_songs_one_artist, get_lyrics)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lyrics_all_songs_for_one_artist,<span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  song_title    lyric                                                           
  &lt;chr&gt;         &lt;chr&gt;                                                           
1 Work          "[Chorus: Rihanna]\nWork, work, work, work, work, workHe said m…
2 The Monster   "[Intro: Rihanna]\nI'm friends with the monster that's under my…
3 Wild Thoughts "[Intro: DJ Khaled]\nAnother oneWe The Best MusicDJ Khaled\n\n[…</code></pre>
</div>
</div>
<ul>
<li><p>Now, last step. We don’t merely want all the song lyrics from a single artist. We want them from all 50 artists! Let’s build another function that takes in an artist page, and then applies the function we just built to each artist page. Below is how we do it!</p></li>
<li><p>The basic steps:</p>
<ul>
<li><p>Create another function. It will take as an argument a URL for an artist’s page</p></li>
<li><p>Within the function, copy/paste the code that we already wrote, specifically, the code found in the above section “Build a list of all the URLs for all song lyrics of a single artist.”</p></li>
<li><p>Now, just take the function we already built and put it within this new function. Yes, you can embed functions within functions!</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>get_all_artists_and_lyrics <span class="ot">&lt;-</span> <span class="cf">function</span>(url_artist) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># read page for a single artist</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">=</span> <span class="fu">read_html</span>(url_artist)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get artist name</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  artist <span class="ot">=</span> <span class="fu">str_remove</span>(url_artist, <span class="st">"https://genius.com/artists/"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get list of song links for a single artist </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  urls_of_songs_one_artist <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">".mini_card_grid-song"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run function that returns all the songs and lyrics for a single artist</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  lyrics_all_songs_for_one_artist <span class="ot">=</span> <span class="fu">map_dfr</span>(urls_of_songs_one_artist, get_lyrics)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the artist name to the tibble that we just created</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  lyrics_all_songs_for_one_artist <span class="ot">=</span> lyrics_all_songs_for_one_artist <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(artist)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Final step!</p></li>
<li><p>Remember very early on we created <code>urls</code> that contains all the URLs for each of the artists in a list.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(urls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://genius.com/artists/Rihanna
https://genius.com/artists/P!nk
https://genius.com/artists/Maroon 5
https://genius.com/artists/Katy Perry
https://genius.com/artists/Justin Timberlake
https://genius.com/artists/Britney Spears</code></pre>
</div>
</div>
<ul>
<li>Well, we want to apply the function we just wrote to that list. Just like so….</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>final_df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(urls[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], get_all_artists_and_lyrics)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>final_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   song_title            lyric                                            artist
   &lt;chr&gt;                 &lt;chr&gt;                                            &lt;chr&gt; 
 1 Work                  "[Chorus: Rihanna]\nWork, work, work, work, wor… Rihan…
 2 The Monster           "[Intro: Rihanna]\nI'm friends with the monster… Rihan…
 3 Wild Thoughts         "[Intro: DJ Khaled]\nAnother oneWe The Best Mus… Rihan…
 4 LOYALTY.              "[Intro: Mr. Talkbox]\n\n[Pre-Chorus: DJ Dahi &amp;… Rihan…
 5 Too Good              "[Intro: Drake]\nOh yeah, yeah, yeah\nOh yeah, … Rihan…
 6 Love the Way You Lie  "[Chorus: Rihanna]\nJust gonna stand there and … Rihan…
 7 Famous                "[Intro: Rihanna &amp; Kanye West]\nMan, I can unde… Rihan…
 8 Love on the Brain     "[Verse 1]\nAnd you got me like, oh\nWhat you w… Rihan…
 9 Needed Me             "[Intro: YG]\nMustard on the beat, ho!\n\n[Vers… Rihan…
10 Take Care             "[Chorus: Rihanna]\nI know you've been hurt by … Rihan…
11 Just Give Me a Reason "[Verse 1: P!nk]\nRight from the start\nYou wer… P!nk  
12 What About Us         "[Intro]\nLa-da-da-da-da, la-da-da-da-da\nDa-da… P!nk  
13 Won’t Back Down       "[Chorus: P!nk]\nYou can sound the alarm, you c… P!nk  
14 Beautiful Trauma      "[Verse 1]\nWe were on fireI slashed your tires… P!nk  
15 Need Me               "[Verse 1: P!nk]\nYou're drunk, the carpet is b… P!nk  
16 Try                   "[Verse 1]\nEver wonder about what he's doingHo… P!nk  
17 Revenge               "[Intro: P!nk]\nMhm, mhm, mhm, mhm, mhm, mhm, m… P!nk  
18 Just Like Fire        "[Verse 1]\nI know that I am runnin' out of tim… P!nk  
19 So What               "[Intro]\nNa-na-na-na-na-na-na, na-na-na-na-na-… P!nk  
20 Who Knew              "[Verse 1]\nYou took my hand, you showed me how… P!nk  </code></pre>
</div>
</div>
</section>
<section id="some-notes-if-curious-but-feel-free-to-skip" class="level3">
<h3 class="anchored" data-anchor-id="some-notes-if-curious-but-feel-free-to-skip">SOME NOTES IF CURIOUS BUT FEEL FREE TO SKIP:</h3>
<ul>
<li><p>Notice in the above I am not applying the function to the entire <code>urls</code> list in the <code>final_df</code> function. This is because the spaces in some of the artists names, like below, will not be recognized by <code>read_html()</code>. To do this properly, I would need to remove that space and replace with a “-”.</p>
<pre><code>https://genius.com/artists/Maroon 5</code></pre></li>
<li><p>When scrapping the lyrics on each individual page, it looks like the CSS selector dynamically changes on a regular basis. So, currently, it shows as <code>html_nodes(".kUgSbL")</code> but you will likely have to change out <code>".kUgSbL"</code> if not working.</p></li>
</ul>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>